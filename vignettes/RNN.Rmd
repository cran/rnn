---
title: "Recurrent Neural Network"
author: "Vignette Author"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Recurrent Neural Network}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

# Package

This package includes an example Recurrent Neural Network.
The package is loaded using:

```{r package}
library(rnn)
```

# Code

We can view the code of the main `rnn()` function by calling it without the parathesis.

```{r code-rnn}
rnn
```

As can be seen from the above, the model relies on three other functions that are included with the package.

The first one is `int2binary`, which stands for **integer to binary**, and converts an integer number to its binary representation:

```{r int2binary}
int2binary(146, length=8)
```

The code for this function is:

```{r int2binary-code}
int2binary
```

The second function is `sigmoid()`, which converts an integer to its sigmoid value.

```{r sigmoid}
(a <- sigmoid(3))
```

The code for the `sigmoid()` function is:

```{r sigmoid-code}
sigmoid
```

The final function converts the sigmoid value of a number to its derivative.

```{r sigmoid-der}
sigmoid_output_to_derivative(a) # a was created above using sigmoid()
```

Finally, we can inspect this code using:

```{r sigmoid-der-code}
sigmoid_output_to_derivative
```

# Application

By setting a **seed** for the random number generator, we ensure replicability.

```{r seed}
set.seed(123)
```

An example is included in the help file.

```{r help, eval=FALSE}
help('rnn')
```

First we generate the data:

```{r data}
# create sample inputs
X1 = sample(0:127, 5000, replace=TRUE)
X2 = sample(0:127, 5000, replace=TRUE)

# create sample output
Y <- X1 + X2
```

This example is:

```{r example}
rnn(Y,
    X1,
    X2,
    binary_dim =  8,
    alpha      =  0.1,
    input_dim  =  2,
    hidden_dim = 10,
    output_dim =  1)
```

It is interesting to vary the number of hidden units and iterations.

```{r example-2}
# create sample inputs
X1 = sample(0:127, 20000, replace=TRUE)
X2 = sample(0:127, 20000, replace=TRUE)

# create sample output
Y <- X1 + X2

rnn(Y,
    X1,
    X2,
    binary_dim = 8,
    alpha      = 0.1,
    input_dim  = 2,
    hidden_dim = 3,
    output_dim = 1)
```
