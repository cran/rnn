<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title>Feed forward pass</title>

<script type="text/javascript">
window.onload = function() {
  var imgs = document.getElementsByTagName('img'), i, img;
  for (i = 0; i < imgs.length; i++) {
    img = imgs[i];
    // center an image if it is the only element of its parent
    if (img.parentElement.childElementCount === 1)
      img.parentElement.style.textAlign = 'center';
  }
};
</script>



<!-- MathJax scripts -->
<script type="text/javascript" src="https://cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML">
</script>


<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 13px;
}

body {
  max-width: 800px;
  margin: auto;
  padding: 1em;
  line-height: 20px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 {
   font-size:2.2em;
}

h2 {
   font-size:1.8em;
}

h3 {
   font-size:1.4em;
}

h4 {
   font-size:1.0em;
}

h5 {
   font-size:0.9em;
}

h6 {
   font-size:0.8em;
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre, img {
  max-width: 100%;
}
pre {
  overflow-x: auto;
}
pre code {
   display: block; padding: 0.5em;
}

code {
  font-size: 92%;
  border: 1px solid #ccc;
}

code[class] {
  background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * {
      background: transparent !important;
      color: black !important;
      filter:none !important;
      -ms-filter: none !important;
   }

   body {
      font-size:12pt;
      max-width:100%;
   }

   a, a:visited {
      text-decoration: underline;
   }

   hr {
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote {
      padding-right: 1em;
      page-break-inside: avoid;
   }

   tr, img {
      page-break-inside: avoid;
   }

   img {
      max-width: 100% !important;
   }

   @page :left {
      margin: 15mm 20mm 15mm 10mm;
   }

   @page :right {
      margin: 15mm 10mm 15mm 20mm;
   }

   p, h2, h3 {
      orphans: 3; widows: 3;
   }

   h2, h3 {
      page-break-after: avoid;
   }
}
</style>



</head>

<body>
<h1>Feed forward pass</h1>

<p><img src="data:image/png;base64,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" alt="plot of chunk feedforward_plot"/></p>

<p>\[ f_t = sigmoid(h_{t-1} * W_f + x_t * U_f) \]</p>

<p>\[ i_t = sigmoid(h_{t-1} * W_i + x_t * U_i) \]</p>

<p>\[ g_t = tanh(h_{t-1} * W_g + x_t * U_g) \]</p>

<p>\[ o_t = sigmoid(h_{t-1} * W_o + x_t * U_o) \]</p>

<p>\[ C_t = C_{t-1} \cdot f_t + i_t \cdot g_t \]</p>

<p>\[ h_t = y_t = tanh(C_t) \cdot o_t \]</p>

<h1>Back propagation pass</h1>

<p><img src="data:image/png;base64,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" alt="plot of chunk BPTT plot"/></p>

<p>To perform the BPTT with a LSTM unit, we have the eror comming from the top layer (\(\delta 1\)), the future cell (\(\delta 4\)), the future hidden state (\(\delta 2\)). Also, we have stored during the feed forward the states at each step of the feeding. In the case of the future layer, this error is just set to zero if not calculated yet. For convention, \(\cdot\) correspond to point wise multiplication, while \(*\) correspond to matrix multiplication.</p>

<p>The rules on how to back prpagate come from <a href="http://practicalcryptography.com/miscellaneous/machine-learning/graphically-determining-backpropagation-equations/">this post</a>.</p>

<p>\[\delta 3 = \delta 1 + \delta 2 \]</p>

<p>\[\delta 5 = \delta 3 \cdot 6 = \delta 3 \cdot o_t \]</p>

<p>\[\delta 6 = \delta 3 \cdot 5 = \delta 3 \cdot tanh(c_t) \]</p>

<p>\[\delta 7 = \delta 5 \cdot f'(5) = \delta 5 \cdot tanh'(tanh(c_t)) \]</p>

<p>\[\delta 8 = \delta 7 \cdot \delta 4  \]</p>

<p>\[\delta 9 = \delta 8 \cdot 10 = \delta 8 \cdot i_t  \]</p>

<p>\[\delta 10 = \delta 8 \cdot 9 = \delta 8 \cdot g_t  \]</p>

<p>\[\delta 11 = \delta 8 \cdot 12 = \delta 8 \cdot f_t  \]</p>

<p>\[\delta 12 = \delta 8 \cdot 11 = \delta 8 \cdot c_{t-1}  \]</p>

<p>\[\delta 13 = \delta 6 \cdot f'(6) = \delta 6 \cdot sigmoid'(o_t) \]
\[\delta 14 = \delta 9 \cdot f'(9) = \delta 9 \cdot tanh'(g_t) \]
\[\delta 15 = \delta 10 \cdot f'(10) = \delta 10 \cdot sigmoid'(i_t) \]
\[\delta 16 = \delta 12 \cdot f'(12) = \delta 12 \cdot sigmoid'(f_t) \]</p>

<p>\[\delta 17 = \delta 13 * U_o^T \]
\[\delta 19 = \delta 14 * U_g^T \]
\[\delta 21 = \delta 15 * U_i^T \]
\[\delta 23 = \delta 16 * W_f^T \]
\[\delta 18 = \delta 13 * W_o^T \]
\[\delta 20 = \delta 14 * W_g^T \]
\[\delta 22 = \delta 16 * W_i^T \]
\[\delta 24 = \delta 16 * W_f^T \]</p>

<p>\[\delta 25 = \delta 18 + \delta 20 + \delta 22 + \delta 24 \]
\[\delta 26 = \delta 17 + \delta 19 + \delta 21 + \delta 23 \]</p>

<p>The error \(\delta 11\), \(\delta 25\) and \(\delta 26\) are used for the next layers. Once all those errors are available, it is possible to calculate the weight update.</p>

<p>\[\delta W_f = \delta W_f + h_{t-1}^T * \delta 16 \]
\[\delta U_f = \delta U_f + x_{t}^T * \delta 16 \]</p>

<p>\[\delta W_i = \delta W_i + h_{t-1}^T * \delta 15 \]
\[\delta U_i = \delta U_i + x_{t}^T * \delta 15 \]</p>

<p>\[\delta W_g = \delta W_g + h_{t-1}^T * \delta 14 \]
\[\delta U_g = \delta U_g + x_{t}^T * \delta 14 \]</p>

<p>\[\delta W_o = \delta W_o + h_{t-1}^T * \delta 13 \]
\[\delta U_o = \delta U_o + x_{t}^T * \delta 13 \]</p>

</body>

</html>
