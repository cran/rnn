<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title>Feed forward pass</title>

<script type="text/javascript">
window.onload = function() {
  var imgs = document.getElementsByTagName('img'), i, img;
  for (i = 0; i < imgs.length; i++) {
    img = imgs[i];
    // center an image if it is the only element of its parent
    if (img.parentElement.childElementCount === 1)
      img.parentElement.style.textAlign = 'center';
  }
};
</script>



<!-- MathJax scripts -->
<script type="text/javascript" src="https://cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML">
</script>


<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 13px;
}

body {
  max-width: 800px;
  margin: auto;
  padding: 1em;
  line-height: 20px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 {
   font-size:2.2em;
}

h2 {
   font-size:1.8em;
}

h3 {
   font-size:1.4em;
}

h4 {
   font-size:1.0em;
}

h5 {
   font-size:0.9em;
}

h6 {
   font-size:0.8em;
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre, img {
  max-width: 100%;
}
pre {
  overflow-x: auto;
}
pre code {
   display: block; padding: 0.5em;
}

code {
  font-size: 92%;
  border: 1px solid #ccc;
}

code[class] {
  background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * {
      background: transparent !important;
      color: black !important;
      filter:none !important;
      -ms-filter: none !important;
   }

   body {
      font-size:12pt;
      max-width:100%;
   }

   a, a:visited {
      text-decoration: underline;
   }

   hr {
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote {
      padding-right: 1em;
      page-break-inside: avoid;
   }

   tr, img {
      page-break-inside: avoid;
   }

   img {
      max-width: 100% !important;
   }

   @page :left {
      margin: 15mm 20mm 15mm 10mm;
   }

   @page :right {
      margin: 15mm 10mm 15mm 20mm;
   }

   p, h2, h3 {
      orphans: 3; widows: 3;
   }

   h2, h3 {
      page-break-after: avoid;
   }
}
</style>



</head>

<body>
<h1>Feed forward pass</h1>

<p><img src="data:image/png;base64,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" alt="plot of chunk feedforward_plot"/></p>

<p>\[ r_t = sigmoid(h_{t-1} * W_r + x_t * U_r) \]</p>

<p>\[ z_t = sigmoid(h_{t-1} * W_z + x_t * U_z) \]</p>

<p>\[ g_t = tanh(W_g * (h_{t-1} \cdot r_t) + x_t * U_g) \]</p>

<p>\[ h_t = y_t = h_{t-1} \cdot (1 - z_t) + (z_t \cdot g_t) \]</p>

<h1>Back propagation pass</h1>

<p><img src="data:image/png;base64,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" alt="plot of chunk BPTT plot"/></p>

<p>To perform the BPTT with a GRU unit, we have the eror comming from the top layer (\(\delta 1\)), the future hidden states (\(\delta 2\)). Also, we have stored during the feed forward the states at each step of the feeding. In the case of the future layer, this error is just set to zero if not calculated yet. For convention, \(\cdot\) correspond to point wise multiplication, while \(*\) correspond to matrix multiplication.</p>

<p>The rules on how to back prpagate come from <a href="http://practicalcryptography.com/miscellaneous/machine-learning/graphically-determining-backpropagation-equations/">this post</a>.</p>

<p>\[\delta 3 = \delta 1 + \delta 2 \]</p>

<p>\[\delta 4 = (1 - z_t) \cdot \delta 3 \]</p>

<p>\[\delta 5 = \delta 3 \cdot h_{t-1} \]</p>

<p>\[\delta 6 = 1 - \delta 5 \]</p>

<p>\[\delta 7 = \delta 3 \cdot g_t \]</p>

<p>\[\delta 8 = \delta 3 \cdot z_t  \]</p>

<p>\[\delta 9 = \delta 7 + \delta 8 \]</p>

<p>\[\delta 10 = \delta 8 \cdot tanh'(g_t)  \]</p>

<p>\[\delta 11 = \delta 9 \cdot sigmoid'(z_t)  \]</p>

<p>\[\delta 12 = \delta 10 * W_g^T \]
\[\delta 13 = \delta 10 * U_g^T \]
\[\delta 14 = \delta 11 * W_z^T \]
\[\delta 15 = \delta 11 * U_z^T \]</p>

<p>\[\delta 16 = \delta 13 \cdot h_{t-1} \]
\[\delta 17 = \delta 13 \cdot r_t  \]</p>

<p>\[\delta 18 = \delta 17 \cdot sigmoid'(r_t)  \]</p>

<p>\[\delta 19 = \delta 17 + \delta 4 \]</p>

<p>\[\delta 20 = \delta 18 * W_r^T \]
\[\delta 21 = \delta 18 * U_r^T \]</p>

<p>\[\delta 22 = \delta 21 + \delta 15 \]</p>

<p>\[\delta 23 = \delta 19 + \delta 22 \]</p>

<p>\[\delta 24 = \delta 12 + \delta 14 +\delta 20 \]</p>

<p>The error \(\delta 23\) and \(\delta 24\) are used for the next layers. Once all those errors are available, it is possible to calculate the weight update.</p>

<p>\[\delta W_r = \delta W_f + h_{t-1}^T * \delta 10 \]
\[\delta U_r = \delta U_f + x_{t}^T * \delta 10 \]</p>

<p>\[\delta W_z = \delta W_i + h_{t-1}^T * \delta 11 \]
\[\delta U_z = \delta U_i + x_{t}^T * \delta 11 \]</p>

<p>\[\delta W_g = \delta W_g + (h_{t-1}^T \cdot r_t) * \delta 18 \]
\[\delta U_g = \delta U_g + x_{t}^T * \delta 18 \]</p>

</body>

</html>
