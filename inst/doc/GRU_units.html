<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Dimitri Fichou" />

<meta name="date" content="2022-07-12" />

<title>GRU units</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>







<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">GRU units</h1>
<h4 class="author">Dimitri Fichou</h4>
<h4 class="date">2022-07-12</h4>



<div id="feed-forward-pass" class="section level1">
<h1>Feed forward pass</h1>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p><span class="math display">\[ r_t = sigmoid(h_{t-1} * W_r + x_t *
U_r) \]</span></p>
<p><span class="math display">\[ z_t = sigmoid(h_{t-1} * W_z + x_t *
U_z) \]</span></p>
<p><span class="math display">\[ g_t = tanh(W_g * (h_{t-1} \cdot r_t) +
x_t * U_g) \]</span></p>
<p><span class="math display">\[ h_t = y_t = h_{t-1} \cdot (1 - z_t) +
(z_t \cdot g_t) \]</span></p>
</div>
<div id="back-propagation-pass" class="section level1">
<h1>Back propagation pass</h1>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>To perform the BPTT with a GRU unit, we have the eror comming from
the top layer (<span class="math inline">\(\delta 1\)</span>), the
future hidden states (<span class="math inline">\(\delta 2\)</span>).
Also, we have stored during the feed forward the states at each step of
the feeding. In the case of the future layer, this error is just set to
zero if not calculated yet. For convention, <span class="math inline">\(\cdot\)</span> correspond to point wise
multiplication, while <span class="math inline">\(*\)</span> correspond
to matrix multiplication.</p>
<p>The rules on how to back prpagate come from <a href="http://practicalcryptography.com/miscellaneous/machine-learning/graphically-determining-backpropagation-equations/">this
post</a>.</p>
<p><span class="math display">\[\delta 3 = \delta 1 + \delta 2
\]</span></p>
<p><span class="math display">\[\delta 4 = (1 - z_t) \cdot \delta 3
\]</span></p>
<p><span class="math display">\[\delta 5 = \delta 3 \cdot h_{t-1}
\]</span></p>
<p><span class="math display">\[\delta 6 = 1 - \delta 5 \]</span></p>
<p><span class="math display">\[\delta 7 = \delta 3 \cdot g_t
\]</span></p>
<p><span class="math display">\[\delta 8 = \delta 3 \cdot
z_t  \]</span></p>
<p><span class="math display">\[\delta 9 = \delta 7 + \delta 8
\]</span></p>
<p><span class="math display">\[\delta 10 = \delta 8 \cdot
tanh&#39;(g_t)  \]</span></p>
<p><span class="math display">\[\delta 11 = \delta 9 \cdot
sigmoid&#39;(z_t)  \]</span></p>
<p><span class="math display">\[\delta 12 = \delta 10 * W_g^T \]</span>
<span class="math display">\[\delta 13 = \delta 10 * U_g^T \]</span>
<span class="math display">\[\delta 14 = \delta 11 * W_z^T \]</span>
<span class="math display">\[\delta 15 = \delta 11 * U_z^T \]</span></p>
<p><span class="math display">\[\delta 16 = \delta 13 \cdot h_{t-1}
\]</span> <span class="math display">\[\delta 17 = \delta 13 \cdot
r_t  \]</span></p>
<p><span class="math display">\[\delta 18 = \delta 17 \cdot
sigmoid&#39;(r_t)  \]</span></p>
<p><span class="math display">\[\delta 19 = \delta 17 + \delta 4
\]</span></p>
<p><span class="math display">\[\delta 20 = \delta 18 * W_r^T \]</span>
<span class="math display">\[\delta 21 = \delta 18 * U_r^T \]</span></p>
<p><span class="math display">\[\delta 22 = \delta 21 + \delta 15
\]</span></p>
<p><span class="math display">\[\delta 23 = \delta 19 + \delta 22
\]</span></p>
<p><span class="math display">\[\delta 24 = \delta 12 + \delta 14
+\delta 20 \]</span></p>
<p>The error <span class="math inline">\(\delta 23\)</span> and <span class="math inline">\(\delta 24\)</span> are used for the next layers.
Once all those errors are available, it is possible to calculate the
weight update.</p>
<p><span class="math display">\[\delta W_r = \delta W_f + h_{t-1}^T *
\delta 10 \]</span> <span class="math display">\[\delta U_r = \delta U_f
+ x_{t}^T * \delta 10 \]</span></p>
<p><span class="math display">\[\delta W_z = \delta W_i + h_{t-1}^T *
\delta 11 \]</span> <span class="math display">\[\delta U_z = \delta U_i
+ x_{t}^T * \delta 11 \]</span></p>
<p><span class="math display">\[\delta W_g = \delta W_g + (h_{t-1}^T
\cdot r_t) * \delta 18 \]</span> <span class="math display">\[\delta U_g
= \delta U_g + x_{t}^T * \delta 18 \]</span></p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
