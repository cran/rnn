<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Dimitri Fichou" />

<meta name="date" content="2022-07-12" />

<title>RNN units</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>







<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">RNN units</h1>
<h4 class="author">Dimitri Fichou</h4>
<h4 class="date">2022-07-12</h4>



<div id="feed-forward-pass" class="section level1">
<h1>Feed forward pass</h1>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p><span class="math display">\[ h_t = y_t = sigmoid(h_{t-1} * W + x_t *
U) \]</span></p>
</div>
<div id="back-propagation-pass" class="section level1">
<h1>Back propagation pass</h1>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>To perform the BPTT with a RNN unit, we have the eror comming from
the top layer (<span class="math inline">\(\delta 1\)</span>), the
future hidden state (<span class="math inline">\(\delta 2\)</span>).
Also, we have stored during the feed forward the states at each step of
the feeding. In the case of the future layer, this error is just set to
zero if not calculated yet. For convention, <span class="math inline">\(\cdot\)</span> correspond to point wise
multiplication, while <span class="math inline">\(*\)</span> correspond
to matrix multiplication.</p>
<p>The rules on how to back prpagate come from <a href="http://practicalcryptography.com/miscellaneous/machine-learning/graphically-determining-backpropagation-equations/">this
post</a>.</p>
<p><span class="math display">\[\delta 3 = \delta 1 + \delta 2
\]</span></p>
<p><span class="math display">\[\delta 4 =  \delta 3 \cdot
sigmoid&#39;(h_t) \]</span></p>
<p><span class="math display">\[\delta 5 = \delta 4 * W^T \]</span>
<span class="math display">\[\delta 6 = \delta 4 * U^T \]</span></p>
<p>The error <span class="math inline">\(\delta 5\)</span> and <span class="math inline">\(\delta 6\)</span> are used for the next layers.
Once all those errors are available, it is possible to calculate the
weight update.</p>
<p><span class="math display">\[\delta W = \delta W + h_{t-1}^T * \delta
4 \]</span></p>
<p><span class="math display">\[\delta U = \delta U + x_{t}^T * \delta 5
\]</span></p>
<p>This should be according to the linked post but in reality, we did it
as follow:</p>
<p><span class="math display">\[\delta 5 = \delta 6 = ((\delta 2 * W^T)
+ (\delta 1 * U^T)) * sigmoid&#39;(h_t) \]</span></p>
<p><span class="math display">\[\delta U = \delta U + x_{t}^T * \delta 1
\]</span></p>
<p><span class="math display">\[\delta W = \delta W + h_{t-1}^T * \delta
2 \]</span></p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
